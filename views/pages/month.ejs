<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Monthly Stats</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="stylesheet" href="/month.css">
  <link rel="shortcut icon" href="/images/gota.png" type="image/x-icon">
</head>

<body>
  <%- include("../components/navbar.ejs", { user }); %>
  <div class="container">
    <h1><strong>Your monthly stats <%= user.name  %>!</strong></h1>

    <h3 id="progress-text">Your progress:</h3>

    <div class="progress" role="progressbar" aria-label="Basic example" aria-valuenow="0" aria-valuemin="0"
      aria-valuemax="100">
      <div id="progress-bar" class="progress-bar" style="width: 17%"></div>
    </div>

    <div class="container text-center histogram">
      <div class="row bars">
        <div id="bar-1" class="col bar"></div>
        <div id="bar-2" class="col bar"></div>
        <div id="bar-3" class="col bar"></div>
        <div id="bar-4" class="col bar"></div>
        <div id="bar-5" class="col bar"></div>
        <div id="bar-6" class="col bar"></div>
        <div id="bar-7" class="col bar"></div>
        <div id="bar-8" class="col bar"></div>
        <div id="bar-9" class="col bar"></div>
        <div id="bar-10" class="col bar"></div>
        <div id="bar-11" class="col bar"></div>
        <div id="bar-12" class="col bar"></div>
      </div>
      <div class="row x-axis">
        <div class="col">01 sep</div>
        <div class="col">02 sep</div>
        <div class="col">03 sep</div>
        <div class="col">04 sep</div>
        <div class="col">05 sep</div>
        <div class="col">06 sep</div>
        <div class="col">07 sep</div>
        <div class="col">08 sep</div>
        <div class="col">09 sep</div>
        <div class="col">10 sep</div>
        <div class="col">11 sep</div>
        <div class="col">12 sep</div>
      </div>
    </div>
    
    <div id="activity-list" class="activities"/>
  </div>

  <script>
    const bars = document.querySelectorAll(".bar");
    const progress_text = document.querySelector("#progress-text");
    const progress_bar = document.querySelector("#progress-bar");
    const activity_list = document.querySelector("#activity-list");

    const activities = [
      {
        name: "plumbing",
        title: "Was plumbing ready!",
        description: "Fixed the pipes",
        img: "/svgs/pipe.svg"
      },
      {
        name: "dishwasher",
        title: "Used the dishwasher correctly!",
        description: "Loaded the dishwasher completely",
        img: "/svgs/dishwasher.svg"
      },
      {
        name: "water tap",
        title: "Kept water from leaking!",
        description: "Kept all water taps closed when not in use",
        img: "/svgs/water-tap.svg"
      },
      {
        name: "shower",
        title: "Responsable shower!",
        description: "Took a shower under 5 minutes",
        img: "/svgs/shower.svg"
      },
      {
        name: "dishes",
        title: "Didn't waste water while cleaning the dishes!",
        description: "Cleaned the dishes limiting the use of water",
        img: "/svgs/plate.svg"
      },
      {
        name: "washing maching",
        title: "Used the washing machine correctly!",
        description: "Loaded the washing machine completely before using it",
        img: "/svgs/washing-machine.svg"
      },
    ];

    const progress = Math.floor(Math.random() * 80 + 20);
    const litres = 20 * progress / 100;

    progress_text.innerText = `${litres} liters, ${progress}% of your current goal!`;
    progress_bar.style.width = `${progress}%`

    for (bar of bars) {
      const height = Math.floor(Math.random() * 150) + 25;
      bar.style.height = `${height}px`;
    }

    for (let i = 0; i < 15; i++) {
      const activity_id = Math.floor(Math.random() * activities.length);
      const div = document.createElement('div');

      div.className = "card mb-3";
      div.style = "width: 45%;"

      div.innerHTML = `
        <div class="row g-0">
          <div class="col-md-4">
            <img src="${activities[activity_id].img}" class="img-fluid rounded-start" alt="${activities[activity_id].name}">
          </div>
          <div class="col-md-8">
            <div class="card-body">
              <h5 class="card-title">${activities[activity_id].title}</h5>
              <p class="card-text">${activities[activity_id].description}</p>
            </div>
          </div>
        </div>
      `;

      activity_list.appendChild(div);
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"></script>
</body>

</html>